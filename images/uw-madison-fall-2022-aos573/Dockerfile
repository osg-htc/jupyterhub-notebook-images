FROM hub.opensciencegrid.org/osg-jupyter/htc-minimal-notebook:1.1.0

# NOTE (baydemir): The following list of packages was constructed by taking
# a diff of two `conda env export`s: one from the course staff, and one from
# the base image.

RUN conda install -y \
      alsa-lib \
      appdirs \
      asciitree \
      atk-1.0 \
      attr \
      basemap \
      bokeh \
      bottleneck \
      brotli \
      brotli-bin \
      cached-property \
      cached_property \
      cairo \
      cartopy \
      celluloid \
      cfgrib \
      cftime \
      click \
      cloudpickle \
      cmocean \
      colorspacious \
      curl \
      cycler \
      cytoolz \
      dask \
      dask-core \
      dask-labextension \
      dask_labextension \
      dbus \
      distributed \
      eccodes \
      esmf \
      esmpy \
      expat \
      fasteners \
      fftw \
      findlibs \
      font-ttf-dejavu-sans-mono \
      font-ttf-inconsolata \
      font-ttf-source-code-pro \
      font-ttf-ubuntu \
      fontconfig \
      fonts-conda-ecosystem \
      fonts-conda-forge \
      fonttools \
      freeglut \
      freetype \
      fribidi \
      fsspec \
      gdk-pixbuf \
      geos \
      gettext \
      giflib \
      gitdb \
      gitpython \
      graphite2 \
      graphviz \
      gst-plugins-base \
      gstreamer \
      gtk2 \
      gts \
      h5netcdf \
      h5py \
      harfbuzz \
      hdf4 \
      hdf5 \
      heapdict \
      ipywidgets \
      jack \
      jasper \
      jbig \
      jpeg \
      json-c \
      jupyter-server-mathjax \
      jupyterlab-git \
      jupyterlab_widgets \
      kiwisolver \
      lcms2 \
      lerc \
      libaec \
      libblas \
      libbrotlicommon \
      libbrotlidec \
      libbrotlienc \
      libcap \
      libcblas \
      libclang \
      libclang13 \
      libcups \
      libdb \
      libdeflate \
      libevent \
      libflac \
      libgd \
      libgfortran-ng \
      libgfortran5 \
      libglib \
      libglu \
      liblapack \
      libllvm14 \
      libnetcdf \
      libogg \
      libopenblas \
      libopus \
      libpng \
      libpq \
      librsvg \
      libsndfile \
      libtiff \
      libtool \
      libvorbis \
      libwebp \
      libwebp-base \
      libxcb \
      libxkbcommon \
      libzip \
      locket \
      lz4 \
      matplotlib \
      matplotlib-base \
      metpy \
      monotonic \
      mscorefonts \
      msgpack-python \
      munkres \
      mysql-common \
      mysql-libs \
      nbconvert-webpdf \
      nbdime \
      nc-time-axis \
      netcdf-fortran \
      netcdf4 \
      nspr \
      nss \
      numcodecs \
      numpy \
      openjpeg \
      pandas \
      pango \
      partd \
      patsy \
      pcre \
      pillow \
      pint \
      pixman \
      pooch \
      proj \
      pthread-stubs \
      pulseaudio \
      pyee \
      pyppeteer \
      pyproj \
      pyqt \
      pyqt5-sip \
      pyqtchart \
      pyshp \
      python-eccodes \
      python-graphviz \
      pyyaml \
      qt-main \
      scipy \
      seaborn \
      seaborn-base \
      shapely \
      sip \
      smmap \
      sortedcontainers \
      sqlite \
      statsmodels \
      tblib \
      toml \
      unicodedata2 \
      websockets \
      widgetsnbextension \
      xarray \
      xorg-fixesproto \
      xorg-inputproto \
      xorg-kbproto \
      xorg-libice \
      xorg-libsm \
      xorg-libx11 \
      xorg-libxau \
      xorg-libxdmcp \
      xorg-libxext \
      xorg-libxfixes \
      xorg-libxi \
      xorg-libxrender \
      xorg-renderproto \
      xorg-xextproto \
      xorg-xproto \
      zarr \
      zict

RUN jupyter labextension install dask-labextension \
    && jupyter serverextension enable --py --sys-prefix dask_labextension

RUN python3 -m pip install siphon

USER $NB_UID:$NB_GID
